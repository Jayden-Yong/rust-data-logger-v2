services:
  ava-device-logger:
    build: .
    container_name: ava-device-logger
    ports:
      - "8080:8080"
    volumes:
      # Persist important data
      - ./docker-data:/app/data
      - ./docker-catalogs:/app/catalogs
      - ./docker-logs:/app/logs
      # Optional: Custom config
      - ./config.docker.toml:/app/config.toml:ro
    environment:
      - RUST_LOG=info
      - DATABASE_URL=/app/data/data.db
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/api/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s

# Optional: Add a database viewer service
  adminer:
    image: adminer
    container_name: ava-adminer
    ports:
      - "8081:8080"
    profiles:
      - debug